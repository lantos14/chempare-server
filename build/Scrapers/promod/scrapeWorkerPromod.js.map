{"version":3,"sources":["../../../src/Scrapers/promod/scrapeWorkerPromod.js"],"names":["phantom","require","scrapeWorker","productName","_ph","create","_page","createPage","on","msg","console","log","status","open","i","evaluate","window","scrollBy","scrapedData","boxes","document","querySelectorAll","priceContainers","objList","length","nameAndImg","priceCont","push","alt","src","innerText","exit"],"mappings":";;;;;;AAAA;;;;;;AACA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;;AAEA,IAAMC,eAAe,eAAfA,YAAe,CAAOC,WAAP,EAAuB;AAC1C;AACA,MAAMC,MAAM,MAAMJ,QAAQK,MAAR,EAAlB;AACA,MAAMC,QAAQ,MAAMF,IAAIG,UAAJ,EAApB;AACA,QAAMD,MAAME,EAAN,CAAS,kBAAT,EAA6B,UAAUC,GAAV,EAAe;AAChDC,YAAQC,GAAR,CAAY,kBAAZ,EAAgCF,GAAhC;AACD,GAFK,CAAN;;AAIA,MAAMG,SAAS,MAAMN,MAAMO,IAAN,gCAAwCV,WAAxC,iBAArB;AACAO,UAAQC,GAAR,CAAY,UAAZ,EAAwBC,MAAxB;;AAEA,OAAK,IAAIE,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AAC1B,UAAMR,MAAMS,QAAN,CAAe,YAAW;AAC9BC,aAAOC,QAAP,CAAgB,CAAhB,EAAmB,IAAnB;AACD,KAFK,CAAN;AAGD;;AAED,MAAMC,cAAc,MAAMZ,MAAMS,QAAN,CAAe,YAAY;AACnDI,YAAQC,SAASC,gBAAT,CAA0B,6BAA1B,CAAR;AACAC,sBAAkBF,SAASC,gBAAT,CAA0B,iCAA1B,CAAlB;AACA,QAAME,UAAU,EAAhB;;AAEA;AACA,SAAK,IAAIT,KAAI,CAAb,EAAgBA,KAAIK,MAAMK,MAA1B,EAAkCV,IAAlC,EAAuC;AACrC,UAAMW,aAAaN,MAAML,EAAN,CAAnB;AACA,UAAMY,YAAYJ,gBAAgBR,EAAhB,CAAlB;AACAS,cAAQI,IAAR,CAAa;AACX,gBAAQF,WAAWG,GADR;AAEX,eAAOH,WAAWI,GAFP;AAGX,iBAASH,UAAUI,SAHR;AAIX,iBAAS;AAJE,OAAb;AAMD;AACD,WAAOP,OAAP;AACD,GAjByB,CAA1B;;AAmBAb,UAAQC,GAAR,CAAY,+BAAZ;AACA,QAAMP,IAAI2B,IAAJ,EAAN;;AAEArB,UAAQC,GAAR,0CAAqDO,YAAYM,MAAjE;AACA,gCAAerB,WAAf,EAA4B,QAA5B,EAAsCe,WAAtC;;AAEA,SAAOA,WAAP;AACD,CA3CD;;kBA6CehB,Y","file":"scrapeWorkerPromod.js","sourcesContent":["import addProductType from '../addProductType';\r\nconst phantom = require(\"phantom\");\r\n\r\nconst scrapeWorker = async (productName) => {\r\n  // scraper functions\r\n  const _ph = await phantom.create();\r\n  const _page = await _ph.createPage();\r\n  await _page.on(\"onConsoleMessage\", function (msg) {\r\n    console.log('---phantom log: ', msg)\r\n  });\r\n\r\n  const status = await _page.open(`https://www.promod.hu/noi/${productName}/index.html`);\r\n  console.log('---log: ', status);\r\n\r\n  for (let i = 0; i < 3; i++) {\r\n    await _page.evaluate(function (){\r\n      window.scrollBy(0, 3000);\r\n    });\r\n  }\r\n\r\n  const scrapedData = await _page.evaluate(function () {\r\n    boxes = document.querySelectorAll('.productBox .imgtooltip img');\r\n    priceContainers = document.querySelectorAll('.productBox .descrip .decimales');\r\n    const objList = [];\r\n\r\n    // get name and img src\r\n    for (let i = 0; i < boxes.length; i++) {\r\n      const nameAndImg = boxes[i];\r\n      const priceCont = priceContainers[i];\r\n      objList.push({\r\n        'name': nameAndImg.alt,\r\n        'img': nameAndImg.src,\r\n        'price': priceCont.innerText,\r\n        'store': 'promod',\r\n      });\r\n    }\r\n    return objList;\r\n  });\r\n\r\n  console.log('---log: _ph.exit fn initiated');\r\n  await _ph.exit();\r\n  \r\n  console.log(`---log: scrapedData length/category: `, scrapedData.length);\r\n  addProductType(productName, 'promod', scrapedData);\r\n\r\n  return scrapedData;\r\n}\r\n\r\nexport default scrapeWorker;\r\n"]}
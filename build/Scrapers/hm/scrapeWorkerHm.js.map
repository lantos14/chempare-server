{"version":3,"sources":["../../../src/Scrapers/hm/scrapeWorkerHm.js"],"names":["phantom","require","scrapeWorker","productName","_ph","create","_page","createPage","status","open","console","log","scrapedData","evaluate","imgTags","document","querySelectorAll","itemHeadings","priceTags","objList","i","length","src","push","innerText","dataset","exit"],"mappings":";;;;;;AAAA;;;;;;AACA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;;AAEA,IAAMC,eAAe,eAAfA,YAAe,CAAOC,WAAP,EAAuB;AAC1C;AACA,MAAMC,MAAM,MAAMJ,QAAQK,MAAR,EAAlB;AACA,MAAMC,QAAQ,MAAMF,IAAIG,UAAJ,EAApB;AACA;AACA;AACA;;AAEA,MAAMC,SAAS,MAAMF,MAAMG,IAAN,4DAAoEN,WAApE,yBAArB;AACAO,UAAQC,GAAR,CAAY,UAAZ,EAAwBH,MAAxB;;AAEA,MAAMI,cAAc,MAAMN,MAAMO,QAAN,CAAe,YAAY;AACnDC,cAAUC,SAASC,gBAAT,CAA0B,oCAA1B,CAAV;AACAC,mBAAeF,SAASC,gBAAT,CAA0B,+BAA1B,CAAf;AACAE,gBAAYH,SAASC,gBAAT,CAA0B,8BAA1B,CAAZ;AACA,QAAMG,UAAU,EAAhB;;AAEA;AACA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIN,QAAQO,MAA5B,EAAoCD,GAApC,EAAyC;AACvCV,cAAQC,GAAR,CAAYG,QAAQM,CAAR,EAAWE,GAAvB;AACAH,cAAQI,IAAR,CAAa;AACX,gBAAQN,aAAaG,CAAb,EAAgBI,SADb;AAEX,eAAOV,QAAQM,CAAR,EAAWK,OAAX,CAAmBH,GAFf;AAGX,iBAASJ,UAAUE,CAAV,EAAaI,SAHX;AAIX,iBAAS;AAJE,OAAb;AAMD;AACD,WAAOL,OAAP;AACD,GAjByB,CAA1B;;AAmBAT,UAAQC,GAAR,CAAY,+BAAZ;AACA,QAAMP,IAAIsB,IAAJ,EAAN;;AAEAhB,UAAQC,GAAR,0CAAqDC,YAAYS,MAAjE;AACA,gCAAelB,WAAf,EAA4BS,WAA5B;;AAEA,SAAOA,WAAP;AACD,CArCD;;kBAuCeV,Y","file":"scrapeWorkerHm.js","sourcesContent":["import addProductType from '../addProductType';\r\nconst phantom = require(\"phantom\");\r\n\r\nconst scrapeWorker = async (productName) => {\r\n  // scraper functions\r\n  const _ph = await phantom.create();\r\n  const _page = await _ph.createPage();\r\n  // await _page.on(\"onConsoleMessage\", function (msg) {\r\n  //   console.log('---phantom log: ', msg)\r\n  // });\r\n\r\n  const status = await _page.open(`https://www2.hm.com/hu_hu/noi/vasarlas-termek-szerint/${productName}.html?page-size=100`);\r\n  console.log('---log: ', status);\r\n\r\n  const scrapedData = await _page.evaluate(function () {\r\n    imgTags = document.querySelectorAll('.product-item .image-container img');\r\n    itemHeadings = document.querySelectorAll('.product-item .item-heading a');\r\n    priceTags = document.querySelectorAll('.product-item .price.regular');\r\n    const objList = [];\r\n\r\n    // get name and img src\r\n    for (let i = 0; i < imgTags.length; i++) {\r\n      console.log(imgTags[i].src);\r\n      objList.push({\r\n        'name': itemHeadings[i].innerText,\r\n        'img': imgTags[i].dataset.src,\r\n        'price': priceTags[i].innerText,\r\n        'store': 'hm',\r\n      });\r\n    }\r\n    return objList;\r\n  });\r\n\r\n  console.log('---log: _ph.exit fn initiated');\r\n  await _ph.exit();\r\n  \r\n  console.log(`---log: scrapedData length/category: `, scrapedData.length);\r\n  addProductType(productName, scrapedData);\r\n\r\n  return scrapedData;\r\n}\r\n\r\nexport default scrapeWorker;\r\n"]}